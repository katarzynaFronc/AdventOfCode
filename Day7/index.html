<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Day7</title>
  </head>
  <body>
    <input type="file" id="fileInput" />
    <script>
      const readFile = (file) => {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = () => resolve(reader.result);
          reader.onerror = reject;
          reader.readAsText(file);
        });
      };

      document.getElementById("fileInput").addEventListener("change", async (e) => {
        const file = e.target.files[0];
        const contents = await readFile(file);

        const cards = contents.split("\n");

        let newHand = [];
        let order;
        let camelCard = {};
        let camelCards = [];
        let sortedCards;

        for (card of cards) {
          let [hand, bid] = card.split(" ");
          let newBid = bid.toString().replace("\r", "");

          newHand = hand.split("");
          // console.log("hand: ", newHand);

          camelCard = { hand: hand, bid: newBid, order: order };

          // console.log(camelCard);

          let count;

          // check the cards
          if (newHand.every((sign) => sign === hand[0])) {
            camelCard = { ...camelCard, order: "1" };
            console.log(camelCard, "five");
          } else if (
            ((count = {}),
            newHand.forEach((sign) => {
              count[sign] = (count[sign] || 0) + 1;
            }),
            Object.values(count).includes(4))
          ) {
            camelCard = { ...camelCard, order: "2" };
            console.log(camelCard, "four");
          } else if (
            ((count = {}),
            newHand.forEach((sign) => {
              count[sign] = (count[sign] || 0) + 1;
            }),
            Object.values(count).includes(3) && Object.values(count).includes(2))
          ) {
            camelCard = { ...camelCard, order: "3" };
            console.log(camelCard, "full house");
          } else if (
            ((count = {}),
            newHand.forEach((sign) => {
              count[sign] = (count[sign] || 0) + 1;
            }),
            Object.values(count).includes(3))
          ) {
            camelCard = { ...camelCard, order: "4" };
            console.log(camelCard, "three");
          } else if (
            ((count = {}),
            newHand.forEach((sign) => {
              count[sign] = (count[sign] || 0) + 1;
            }),
            Object.values(count).filter((x) => x === 2).length === 2)
          ) {
            camelCard = { ...camelCard, order: "5" };
            console.log(camelCard, "two pair");
          } else if (
            ((count = {}),
            newHand.forEach((sign) => {
              count[sign] = (count[sign] || 0) + 1;
            }),
            Object.values(count).includes(2))
          ) {
            camelCard = { ...camelCard, order: "6" };
            console.log(camelCard, "one pair");
          } else if (newHand.every((sign, index, self) => self.indexOf(sign) === index)) {
            camelCard = { ...camelCard, order: "7" };
            console.log(camelCard, "high");
          }
          camelCards.push(camelCard);
        }

        sortedCards = camelCards.sort(function (a, b) {
          return a.order - b.order;
        });
        console.log(sortedCards);
      });
    </script>
  </body>
</html>
